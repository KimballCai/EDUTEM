02-08-21 11:40:Timestamp: 20210208114032
02-08-21 11:40:Arguments:Namespace(application='inhos_mortality', batch_size=64, clip_max=3.0, clip_min=-3.0, compress_dim=4, data_clip=False, data_clip_max=inf, data_clip_min=-inf, dataset='physionet2012', dataset_mode='regular', debug=False, embed_dim=24, epoch=200, ffill=True, ffill_steps=48, folds=[0], gpu='0,1,2', hidden_dim=64, lr=0.001, max_timesteps=48, mode='train', model='EDUTEM', model_path='', patience=10, random=False, standardization=True, weight_decay=1e-07)
02-08-21 11:40:[*] Loading dataset: physionet2012
02-08-21 11:40:fold path: inhos_mortality_folds.npz
02-08-21 11:40:train: [150491 143937 148710 140049 156691]
02-08-21 11:41:train: 9600 valid: 1200 test: 1200
02-08-21 11:41:Model: "model_1"
02-08-21 11:41:__________________________________________________________________________________________________
02-08-21 11:41:Layer (type)                    Output Shape         Param #     Connected to                     
02-08-21 11:41:==================================================================================================
02-08-21 11:41:input_3 (InputLayer)            (None, 48, 37)       0                                            
02-08-21 11:41:__________________________________________________________________________________________________
02-08-21 11:41:input_4 (InputLayer)            (None, 48, 37)       0                                            
02-08-21 11:41:__________________________________________________________________________________________________
02-08-21 11:41:edutem_f_1 (EDUTEM_f)           (None, 48, 148)      3781        input_3[0][0]                    
02-08-21 11:41:                                                                 input_4[0][0]                    
02-08-21 11:41:__________________________________________________________________________________________________
02-08-21 11:41:gru_1 (GRU)                     (None, 48, 64)       40896       edutem_f_1[0][0]                 
02-08-21 11:41:__________________________________________________________________________________________________
02-08-21 11:41:edutem_t_1 (EDUTEM_t)           (None, 128)          65          gru_1[0][0]                      
02-08-21 11:41:__________________________________________________________________________________________________
02-08-21 11:41:dense_1 (Dense)                 (None, 64)           8256        edutem_t_1[0][0]                 
02-08-21 11:41:__________________________________________________________________________________________________
02-08-21 11:41:dense_2 (Dense)                 (None, 1)            65          dense_1[0][0]                    
02-08-21 11:41:==================================================================================================
02-08-21 11:41:Total params: 53,063
02-08-21 11:41:Trainable params: 53,063
02-08-21 11:41:Non-trainable params: 0
02-08-21 11:41:__________________________________________________________________________________________________
02-08-21 11:41:[EDUTEM Epoch 1]
02-08-21 11:41:[train] bceloss:0.3636 auroc:0.7511 auprc:0.3603 acc:0.8585 
02-08-21 11:41:[valid] bceloss:0.3632 auroc:0.7536 auprc:0.3953 acc:0.8583 
02-08-21 11:41:[*] model_0.h5 saved 
02-08-21 11:41:[test] bceloss:0.3715 auroc:0.7190 auprc:0.3733 acc:0.8592 
02-08-21 11:42:[EDUTEM Epoch 2]
02-08-21 11:42:[train] bceloss:0.3143 auroc:0.8388 auprc:0.4872 acc:0.8696 
02-08-21 11:42:[valid] bceloss:0.3297 auroc:0.8105 auprc:0.4792 acc:0.8675 
02-08-21 11:42:[*] model_0.h5 saved 
02-08-21 11:42:[test] bceloss:0.3199 auroc:0.8374 auprc:0.4702 acc:0.8658 
02-08-21 11:42:[EDUTEM Epoch 3]
02-08-21 11:42:[train] bceloss:0.3090 auroc:0.8516 auprc:0.5185 acc:0.8693 
02-08-21 11:42:[valid] bceloss:0.3226 auroc:0.8245 auprc:0.5019 acc:0.8725 
02-08-21 11:42:[*] model_0.h5 saved 
02-08-21 11:42:[test] bceloss:0.3091 auroc:0.8517 auprc:0.4907 acc:0.8683 
02-08-21 11:42:[EDUTEM Epoch 4]
02-08-21 11:42:[train] bceloss:0.2952 auroc:0.8567 auprc:0.5302 acc:0.8769 
02-08-21 11:42:[valid] bceloss:0.3098 auroc:0.8335 auprc:0.5153 acc:0.8800 
02-08-21 11:42:[*] model_0.h5 saved 
02-08-21 11:42:[test] bceloss:0.2984 auroc:0.8580 auprc:0.4966 acc:0.8683 
02-08-21 11:43:[EDUTEM Epoch 5]
02-08-21 11:43:[train] bceloss:0.2918 auroc:0.8611 auprc:0.5409 acc:0.8784 
02-08-21 11:43:[valid] bceloss:0.3072 auroc:0.8375 auprc:0.5219 acc:0.8808 
02-08-21 11:43:[*] model_0.h5 saved 
02-08-21 11:43:[test] bceloss:0.2956 auroc:0.8619 auprc:0.5066 acc:0.8733 
02-08-21 11:43:[EDUTEM Epoch 6]
02-08-21 11:43:[train] bceloss:0.2902 auroc:0.8639 auprc:0.5477 acc:0.8796 
02-08-21 11:43:[valid] bceloss:0.3036 auroc:0.8409 auprc:0.5295 acc:0.8800 
02-08-21 11:43:[*] model_0.h5 saved 
02-08-21 11:43:[test] bceloss:0.2924 auroc:0.8644 auprc:0.5136 acc:0.8750 
02-08-21 11:44:[EDUTEM Epoch 7]
02-08-21 11:44:[train] bceloss:0.2928 auroc:0.8649 auprc:0.5498 acc:0.8788 
02-08-21 11:44:[valid] bceloss:0.3083 auroc:0.8435 auprc:0.5355 acc:0.8775 
02-08-21 11:44:[test] bceloss:0.2996 auroc:0.8640 auprc:0.5130 acc:0.8683 
02-08-21 11:44:[EDUTEM Epoch 8]
02-08-21 11:44:[train] bceloss:0.2865 auroc:0.8666 auprc:0.5541 acc:0.8816 
02-08-21 11:44:[valid] bceloss:0.3000 auroc:0.8447 auprc:0.5388 acc:0.8850 
02-08-21 11:44:[*] model_0.h5 saved 
02-08-21 11:44:[test] bceloss:0.2902 auroc:0.8654 auprc:0.5181 acc:0.8767 
02-08-21 11:44:[EDUTEM Epoch 9]
02-08-21 11:44:[train] bceloss:0.3109 auroc:0.8680 auprc:0.5584 acc:0.8675 
02-08-21 11:44:[valid] bceloss:0.3224 auroc:0.8430 auprc:0.5363 acc:0.8642 
02-08-21 11:44:[test] bceloss:0.3074 auroc:0.8700 auprc:0.5175 acc:0.8708 
02-08-21 11:45:[EDUTEM Epoch 10]
02-08-21 11:45:[train] bceloss:0.2893 auroc:0.8691 auprc:0.5596 acc:0.8776 
02-08-21 11:45:[valid] bceloss:0.3071 auroc:0.8453 auprc:0.5402 acc:0.8783 
02-08-21 11:45:[test] bceloss:0.2949 auroc:0.8686 auprc:0.5287 acc:0.8692 
02-08-21 11:45:[EDUTEM Epoch 11]
02-08-21 11:45:[train] bceloss:0.2845 auroc:0.8700 auprc:0.5633 acc:0.8791 
02-08-21 11:45:[valid] bceloss:0.3020 auroc:0.8440 auprc:0.5371 acc:0.8800 
02-08-21 11:45:[test] bceloss:0.2873 auroc:0.8711 auprc:0.5271 acc:0.8725 
02-08-21 11:45:[EDUTEM Epoch 12]
02-08-21 11:45:[train] bceloss:0.2844 auroc:0.8701 auprc:0.5645 acc:0.8770 
02-08-21 11:45:[valid] bceloss:0.2984 auroc:0.8478 auprc:0.5464 acc:0.8808 
02-08-21 11:45:[*] model_0.h5 saved 
02-08-21 11:45:[test] bceloss:0.2878 auroc:0.8690 auprc:0.5195 acc:0.8692 
02-08-21 11:46:[EDUTEM Epoch 13]
02-08-21 11:46:[train] bceloss:0.2829 auroc:0.8702 auprc:0.5660 acc:0.8824 
02-08-21 11:46:[valid] bceloss:0.2970 auroc:0.8484 auprc:0.5491 acc:0.8867 
02-08-21 11:46:[*] model_0.h5 saved 
02-08-21 11:46:[test] bceloss:0.2893 auroc:0.8665 auprc:0.5175 acc:0.8708 
02-08-21 11:46:[EDUTEM Epoch 14]
02-08-21 11:46:[train] bceloss:0.2835 auroc:0.8725 auprc:0.5691 acc:0.8815 
02-08-21 11:46:[valid] bceloss:0.3009 auroc:0.8483 auprc:0.5482 acc:0.8825 
02-08-21 11:46:[test] bceloss:0.2890 auroc:0.8710 auprc:0.5300 acc:0.8708 
02-08-21 11:47:[EDUTEM Epoch 15]
02-08-21 11:47:[train] bceloss:0.2923 auroc:0.8720 auprc:0.5688 acc:0.8786 
02-08-21 11:47:[valid] bceloss:0.3132 auroc:0.8458 auprc:0.5425 acc:0.8767 
02-08-21 11:47:[test] bceloss:0.2965 auroc:0.8741 auprc:0.5366 acc:0.8717 
02-08-21 11:47:[EDUTEM Epoch 16]
02-08-21 11:47:[train] bceloss:0.2849 auroc:0.8744 auprc:0.5755 acc:0.8815 
02-08-21 11:47:[valid] bceloss:0.3058 auroc:0.8489 auprc:0.5492 acc:0.8817 
02-08-21 11:47:[test] bceloss:0.2904 auroc:0.8742 auprc:0.5326 acc:0.8717 
02-08-21 11:47:[EDUTEM Epoch 17]
02-08-21 11:47:[train] bceloss:0.3019 auroc:0.8755 auprc:0.5769 acc:0.8761 
02-08-21 11:47:[valid] bceloss:0.3252 auroc:0.8492 auprc:0.5478 acc:0.8725 
02-08-21 11:47:[test] bceloss:0.3100 auroc:0.8745 auprc:0.5390 acc:0.8700 
02-08-21 11:48:[EDUTEM Epoch 18]
02-08-21 11:48:[train] bceloss:0.2794 auroc:0.8765 auprc:0.5817 acc:0.8824 
02-08-21 11:48:[valid] bceloss:0.2970 auroc:0.8511 auprc:0.5546 acc:0.8858 
02-08-21 11:48:[test] bceloss:0.2843 auroc:0.8756 auprc:0.5405 acc:0.8725 
02-08-21 11:48:[EDUTEM Epoch 19]
02-08-21 11:48:[train] bceloss:0.2792 auroc:0.8772 auprc:0.5862 acc:0.8814 
02-08-21 11:48:[valid] bceloss:0.2948 auroc:0.8524 auprc:0.5605 acc:0.8808 
02-08-21 11:48:[*] model_0.h5 saved 
02-08-21 11:48:[test] bceloss:0.2837 auroc:0.8739 auprc:0.5347 acc:0.8792 
02-08-21 11:49:[EDUTEM Epoch 20]
02-08-21 11:49:[train] bceloss:0.2780 auroc:0.8778 auprc:0.5855 acc:0.8847 
02-08-21 11:49:[valid] bceloss:0.2982 auroc:0.8517 auprc:0.5567 acc:0.8858 
02-08-21 11:49:[test] bceloss:0.2832 auroc:0.8779 auprc:0.5444 acc:0.8750 
02-08-21 11:49:[EDUTEM Epoch 21]
02-08-21 11:49:[train] bceloss:0.2748 auroc:0.8794 auprc:0.5917 acc:0.8854 
02-08-21 11:49:[valid] bceloss:0.2957 auroc:0.8527 auprc:0.5610 acc:0.8875 
02-08-21 11:49:[test] bceloss:0.2826 auroc:0.8757 auprc:0.5415 acc:0.8775 
02-08-21 11:49:[EDUTEM Epoch 22]
02-08-21 11:49:[train] bceloss:0.2954 auroc:0.8802 auprc:0.5956 acc:0.8743 
02-08-21 11:49:[valid] bceloss:0.3112 auroc:0.8509 auprc:0.5577 acc:0.8692 
02-08-21 11:49:[test] bceloss:0.2952 auroc:0.8778 auprc:0.5448 acc:0.8675 
02-08-21 11:50:[EDUTEM Epoch 23]
02-08-21 11:50:[train] bceloss:0.2772 auroc:0.8807 auprc:0.5949 acc:0.8859 
02-08-21 11:50:[valid] bceloss:0.3017 auroc:0.8517 auprc:0.5572 acc:0.8825 
02-08-21 11:50:[test] bceloss:0.2824 auroc:0.8819 auprc:0.5551 acc:0.8767 
02-08-21 11:50:[EDUTEM Epoch 24]
02-08-21 11:50:[train] bceloss:0.2724 auroc:0.8824 auprc:0.6021 acc:0.8877 
02-08-21 11:50:[valid] bceloss:0.2953 auroc:0.8555 auprc:0.5628 acc:0.8850 
02-08-21 11:50:[test] bceloss:0.2798 auroc:0.8810 auprc:0.5569 acc:0.8808 
02-08-21 11:51:[EDUTEM Epoch 25]
02-08-21 11:51:[train] bceloss:0.2763 auroc:0.8836 auprc:0.6052 acc:0.8839 
02-08-21 11:51:[valid] bceloss:0.3009 auroc:0.8566 auprc:0.5637 acc:0.8858 
02-08-21 11:51:[test] bceloss:0.2864 auroc:0.8815 auprc:0.5541 acc:0.8775 
02-08-21 11:51:[EDUTEM Epoch 26]
02-08-21 11:51:[train] bceloss:0.2738 auroc:0.8843 auprc:0.6064 acc:0.8849 
02-08-21 11:51:[valid] bceloss:0.2995 auroc:0.8532 auprc:0.5595 acc:0.8833 
02-08-21 11:51:[test] bceloss:0.2788 auroc:0.8858 auprc:0.5694 acc:0.8783 
02-08-21 11:51:[EDUTEM Epoch 27]
02-08-21 11:51:[train] bceloss:0.2708 auroc:0.8858 auprc:0.6119 acc:0.8855 
02-08-21 11:51:[valid] bceloss:0.2982 auroc:0.8532 auprc:0.5595 acc:0.8825 
02-08-21 11:51:[test] bceloss:0.2770 auroc:0.8865 auprc:0.5700 acc:0.8833 
02-08-21 11:52:[EDUTEM Epoch 28]
02-08-21 11:52:[train] bceloss:0.2663 auroc:0.8865 auprc:0.6165 acc:0.8875 
02-08-21 11:52:[valid] bceloss:0.2921 auroc:0.8563 auprc:0.5650 acc:0.8833 
02-08-21 11:52:[*] model_0.h5 saved 
02-08-21 11:52:[test] bceloss:0.2747 auroc:0.8836 auprc:0.5636 acc:0.8850 
02-08-21 11:52:[EDUTEM Epoch 29]
02-08-21 11:52:[train] bceloss:0.2657 auroc:0.8872 auprc:0.6201 acc:0.8908 
02-08-21 11:52:[valid] bceloss:0.2921 auroc:0.8564 auprc:0.5666 acc:0.8833 
02-08-21 11:52:[*] model_0.h5 saved 
02-08-21 11:52:[test] bceloss:0.2742 auroc:0.8852 auprc:0.5683 acc:0.8842 
02-08-21 11:52:[EDUTEM Epoch 30]
02-08-21 11:52:[train] bceloss:0.2735 auroc:0.8888 auprc:0.6235 acc:0.8874 
02-08-21 11:52:[valid] bceloss:0.3029 auroc:0.8592 auprc:0.5696 acc:0.8842 
02-08-21 11:52:[test] bceloss:0.2868 auroc:0.8852 auprc:0.5725 acc:0.8808 
02-08-21 11:53:[EDUTEM Epoch 31]
02-08-21 11:53:[train] bceloss:0.2640 auroc:0.8907 auprc:0.6287 acc:0.8892 
02-08-21 11:53:[valid] bceloss:0.2916 auroc:0.8589 auprc:0.5690 acc:0.8817 
02-08-21 11:53:[*] model_0.h5 saved 
02-08-21 11:53:[test] bceloss:0.2741 auroc:0.8870 auprc:0.5754 acc:0.8892 
02-08-21 11:53:[EDUTEM Epoch 32]
02-08-21 11:53:[train] bceloss:0.2698 auroc:0.8912 auprc:0.6312 acc:0.8879 
02-08-21 11:53:[valid] bceloss:0.3011 auroc:0.8600 auprc:0.5721 acc:0.8842 
02-08-21 11:53:[test] bceloss:0.2859 auroc:0.8850 auprc:0.5699 acc:0.8842 
02-08-21 11:54:[EDUTEM Epoch 33]
02-08-21 11:54:[train] bceloss:0.2605 auroc:0.8916 auprc:0.6331 acc:0.8922 
02-08-21 11:54:[valid] bceloss:0.2887 auroc:0.8611 auprc:0.5739 acc:0.8817 
02-08-21 11:54:[*] model_0.h5 saved 
02-08-21 11:54:[test] bceloss:0.2744 auroc:0.8847 auprc:0.5719 acc:0.8817 
02-08-21 11:54:[EDUTEM Epoch 34]
02-08-21 11:54:[train] bceloss:0.2615 auroc:0.8930 auprc:0.6368 acc:0.8910 
02-08-21 11:54:[valid] bceloss:0.2934 auroc:0.8590 auprc:0.5638 acc:0.8817 
02-08-21 11:54:[test] bceloss:0.2739 auroc:0.8882 auprc:0.5787 acc:0.8892 
02-08-21 11:54:[EDUTEM Epoch 35]
02-08-21 11:54:[train] bceloss:0.2592 auroc:0.8949 auprc:0.6441 acc:0.8913 
02-08-21 11:54:[valid] bceloss:0.2954 auroc:0.8581 auprc:0.5631 acc:0.8825 
02-08-21 11:54:[test] bceloss:0.2758 auroc:0.8873 auprc:0.5754 acc:0.8892 
02-08-21 11:55:[EDUTEM Epoch 36]
02-08-21 11:55:[train] bceloss:0.2614 auroc:0.8957 auprc:0.6462 acc:0.8906 
02-08-21 11:55:[valid] bceloss:0.2916 auroc:0.8604 auprc:0.5655 acc:0.8758 
02-08-21 11:55:[test] bceloss:0.2769 auroc:0.8835 auprc:0.5714 acc:0.8792 
02-08-21 11:55:[EDUTEM Epoch 37]
02-08-21 11:55:[train] bceloss:0.2640 auroc:0.8971 auprc:0.6510 acc:0.8915 
02-08-21 11:55:[valid] bceloss:0.3035 auroc:0.8593 auprc:0.5679 acc:0.8792 
02-08-21 11:55:[test] bceloss:0.2841 auroc:0.8881 auprc:0.5801 acc:0.8842 
02-08-21 11:56:[EDUTEM Epoch 38]
02-08-21 11:56:[train] bceloss:0.2566 auroc:0.8978 auprc:0.6517 acc:0.8935 
02-08-21 11:56:[valid] bceloss:0.2971 auroc:0.8590 auprc:0.5634 acc:0.8792 
02-08-21 11:56:[test] bceloss:0.2784 auroc:0.8865 auprc:0.5740 acc:0.8833 
02-08-21 11:56:[EDUTEM Epoch 39]
02-08-21 11:56:[train] bceloss:0.2560 auroc:0.8994 auprc:0.6595 acc:0.8911 
02-08-21 11:56:[valid] bceloss:0.2974 auroc:0.8579 auprc:0.5556 acc:0.8775 
02-08-21 11:56:[test] bceloss:0.2772 auroc:0.8843 auprc:0.5715 acc:0.8775 
02-08-21 11:56:[EDUTEM Epoch 40]
02-08-21 11:56:[train] bceloss:0.2531 auroc:0.9007 auprc:0.6599 acc:0.8945 
02-08-21 11:56:[valid] bceloss:0.2972 auroc:0.8584 auprc:0.5604 acc:0.8750 
02-08-21 11:56:[test] bceloss:0.2761 auroc:0.8866 auprc:0.5768 acc:0.8908 
02-08-21 11:57:[EDUTEM Epoch 41]
02-08-21 11:57:[train] bceloss:0.2537 auroc:0.9015 auprc:0.6634 acc:0.8956 
02-08-21 11:57:[valid] bceloss:0.3001 auroc:0.8599 auprc:0.5649 acc:0.8775 
02-08-21 11:57:[test] bceloss:0.2816 auroc:0.8849 auprc:0.5734 acc:0.8883 
02-08-21 11:57:[EDUTEM Epoch 42]
02-08-21 11:57:[train] bceloss:0.2497 auroc:0.9025 auprc:0.6674 acc:0.8973 
02-08-21 11:57:[valid] bceloss:0.2925 auroc:0.8579 auprc:0.5517 acc:0.8800 
02-08-21 11:57:[test] bceloss:0.2766 auroc:0.8812 auprc:0.5651 acc:0.8842 
02-08-21 11:57:[EDUTEM Epoch 43]
02-08-21 11:57:[train] bceloss:0.2488 auroc:0.9051 auprc:0.6762 acc:0.8999 
02-08-21 11:57:[valid] bceloss:0.2970 auroc:0.8536 auprc:0.5463 acc:0.8808 
02-08-21 11:57:[test] bceloss:0.2752 auroc:0.8837 auprc:0.5701 acc:0.8825 
02-08-21 11:57:      Epoch bceloss   auroc   auprc     acc
train    43  0.2605  0.8916  0.6331  0.8922
valid    33  0.2887  0.8611  0.5739  0.8817
test     34  0.2744  0.8847  0.5719  0.8817
train    43  0.2605  0.8916  0.6331  0.8922
valid    33  0.2887  0.8611  0.5739  0.8817
test     37  0.2744  0.8847  0.5719  0.8817
train    43  0.2605  0.8916  0.6331  0.8922
valid    33  0.2887  0.8611  0.5739  0.8817
test     34  0.2744  0.8847  0.5719  0.8817
02-08-21 11:57:[Eval]
02-08-21 11:58:[EDUTEM Epoch 0]
02-08-21 11:58:[train] bceloss:0.2605 auroc:0.8916 auprc:0.6331 acc:0.8922 
02-08-21 11:58:[valid] bceloss:0.2887 auroc:0.8611 auprc:0.5739 acc:0.8817 
02-08-21 11:58:[test] bceloss:0.2744 auroc:0.8847 auprc:0.5719 acc:0.8817 
